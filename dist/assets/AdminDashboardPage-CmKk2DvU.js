import{j as e,A as U,m as _}from"./motion-DpbDtNjy.js";import{r}from"./vendor-CjctPQyD.js";import{r as q,g as J,a as W,b as G,c as K,d as Q,e as X,f as Y,h as Z,i as ee}from"./index-C5JXRomi.js";import{S as se}from"./SEO-ClowiUGc.js";import{m as ae,R as te,n as re,c as le,j as de,o as d,g as f,p as u,q as k,E as ie,r as ce}from"./icons-DIj--cob.js";import"./router-Bml8sYE4.js";const ne=()=>window.location.pathname.includes("/admin"),oe=()=>{window.location.href="/"},xe=()=>{const[j,D]=r.useState([]),[p,S]=r.useState([]),[n,z]=r.useState([]),[o,A]=r.useState([]),[v,C]=r.useState(0),[N,$]=r.useState([]),[y,P]=r.useState([]),[i,R]=r.useState([]),[x,V]=r.useState(!0),[m,g]=r.useState(!1),[t,l]=r.useState("overview");r.useEffect(()=>{(()=>{if(!ne()){window.location.href="/";return}})()},[]);const h=async()=>{try{const[s,a,b,F,M,B,H,O]=await Promise.all([J(),W(),G(),K(),Q(),X(),Y(),Z()]);D(s),S(a),z(b),A(F),C(M),$(B.slice(0,20)),P(H),R(O)}catch(s){console.error("分析データ取得エラー:",s)}finally{V(!1),g(!1)}};r.useEffect(()=>{h()},[]),r.useEffect(()=>{const s=setInterval(()=>{x||(g(!0),h())},3e5);return()=>clearInterval(s)},[x]);const E=()=>{g(!0),h()},T=async()=>{try{await ee("/admin"),alert("テストページビューを記録しました。更新ボタンを押して確認してください。")}catch(s){console.error("テストページビューエラー:",s),alert("テストページビューの記録に失敗しました。")}},I=s=>["日","月","火","水","木","金","土"][s],w=s=>{switch(s){case"desktop":return e.jsx(d,{size:16});case"mobile":return e.jsx(ce,{size:16});case"tablet":return e.jsx(d,{size:16});default:return e.jsx(d,{size:16})}},c=s=>Math.max(...s.map(a=>a.count),1),L=s=>new Date(s).toLocaleString("ja-JP");return x?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#0a0a0a] to-[#181818] text-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#d4af37] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"分析データを読み込み中..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0a0a0a] to-[#181818] text-white",children:[e.jsx(se,{title:"管理者分析 | 矢田谷充則のコーチング",description:"管理者専用のアクセス分析ダッシュボード"}),e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border-b border-[#d4af37]/30 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ae,{size:32,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-[#d4af37]",children:"管理者分析ダッシュボード"}),e.jsx("p",{className:"text-gray-400",children:"リアルタイムアクセス分析"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-[#d4af37]",children:v.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-400",children:"累積PV"})]}),e.jsxs("button",{onClick:E,disabled:m,className:"px-4 py-2 bg-blue-700 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(te,{size:16,className:m?"animate-spin":""}),m?"更新中...":"更新"]}),e.jsx("button",{onClick:T,className:"px-4 py-2 bg-green-700 text-white rounded-lg hover:bg-green-600 transition-colors",children:"テストPV追加"}),e.jsx("button",{onClick:oe,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"ログアウト"}),e.jsx("button",{onClick:q,className:"px-4 py-2 bg-red-700 text-white rounded-lg hover:bg-red-600 transition-colors",children:"データをリセット"})]})]})})}),e.jsx("div",{className:"bg-black/30 backdrop-blur-sm border-b border-[#d4af37]/20 p-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex gap-2 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>l("overview"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${t==="overview"?"bg-[#d4af37] text-[#181818]":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(re,{size:16}),"概要"]}),e.jsxs("button",{onClick:()=>l("hourly"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${t==="hourly"?"bg-[#d4af37] text-[#181818]":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(le,{size:16}),"時間帯分析"]}),e.jsxs("button",{onClick:()=>l("daily"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${t==="daily"?"bg-[#d4af37] text-[#181818]":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(de,{size:16}),"曜日分析"]}),e.jsxs("button",{onClick:()=>l("device"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${t==="device"?"bg-[#d4af37] text-[#181818]":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(d,{size:16}),"デバイス分析"]}),e.jsxs("button",{onClick:()=>l("browser"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${t==="browser"?"bg-[#d4af37] text-[#181818]":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(f,{size:16}),"ブラウザ分析"]}),e.jsxs("button",{onClick:()=>l("recent"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${t==="recent"?"bg-[#d4af37] text-[#181818]":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(u,{size:16}),"最近のアクセス"]}),e.jsxs("button",{onClick:()=>l("funnel"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${t==="funnel"?"bg-[#d4af37] text-[#181818]":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[e.jsx(k,{size:16}),"ファネル分析"]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsx(U,{mode:"wait",children:e.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[t==="overview"&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ie,{size:24,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:v.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-400",children:"累積PV"})]})]})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{size:24,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:N.length}),e.jsx("div",{className:"text-sm text-gray-400",children:"最近のアクセス"})]})]})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{size:24,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:n.length}),e.jsx("div",{className:"text-sm text-gray-400",children:"デバイス種類"})]})]})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{size:24,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:o.length}),e.jsx("div",{className:"text-sm text-gray-400",children:"ブラウザ種類"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{size:24,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:y.length}),e.jsx("div",{className:"text-sm text-gray-400",children:"流入元数"})]})]})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{size:24,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:i.filter(s=>s.source==="instagram"||s.source==="x"||s.source==="tiktok").length}),e.jsx("div",{className:"text-sm text-gray-400",children:"SNS流入"})]})]})}),e.jsx("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{size:24,className:"text-[#d4af37]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:i.filter(s=>s.source==="google"||s.source==="yahoo").length}),e.jsx("div",{className:"text-sm text-gray-400",children:"検索流入"})]})]})})]})]}),t==="hourly"&&e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#d4af37] mb-6",children:"時間帯別アクセス数"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:j.map(s=>{const a=s.count/c(j)*100;return e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-lg font-medium text-white",children:[s.hour.toString().padStart(2,"0"),":00"]}),e.jsx("span",{className:"text-[#d4af37] font-bold",children:s.count})]}),e.jsx("div",{className:"bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-[#d4af37] to-[#ffd700] h-3 rounded-full transition-all duration-500",style:{width:`${a}%`}})})]},s.hour)})})]}),t==="daily"&&e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#d4af37] mb-6",children:"曜日別アクセス数"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:p.map(s=>{const a=s.count/c(p)*100;return e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-lg font-medium text-white",children:I(s.day)}),e.jsx("span",{className:"text-[#d4af37] font-bold",children:s.count})]}),e.jsx("div",{className:"bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-[#d4af37] to-[#ffd700] h-3 rounded-full transition-all duration-500",style:{width:`${a}%`}})})]},s.day)})})]}),t==="device"&&e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#d4af37] mb-6",children:"デバイス別アクセス数"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:n.map(s=>{const a=s.count/c(n)*100;return e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[w(s.device),e.jsx("span",{className:"text-lg font-medium text-white",children:s.device==="desktop"?"PC":s.device==="mobile"?"スマホ":"タブレット"})]}),e.jsx("div",{className:"text-2xl font-bold text-[#d4af37] mb-2",children:s.count}),e.jsx("div",{className:"bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-[#d4af37] to-[#ffd700] h-2 rounded-full transition-all duration-500",style:{width:`${a}%`}})})]},s.device)})})]}),t==="browser"&&e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#d4af37] mb-6",children:"ブラウザ別アクセス数"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(s=>{const a=s.count/c(o)*100;return e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-lg font-medium text-white mb-3",children:s.browser}),e.jsx("div",{className:"text-2xl font-bold text-[#d4af37] mb-2",children:s.count}),e.jsx("div",{className:"bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-[#d4af37] to-[#ffd700] h-2 rounded-full transition-all duration-500",style:{width:`${a}%`}})})]},s.browser)})})]}),t==="recent"&&e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#d4af37] mb-6",children:"最近のアクセス"}),e.jsx("div",{className:"space-y-4",children:N.map((s,a)=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[w(s.device_type),e.jsx("span",{className:"text-sm text-gray-400",children:s.browser})]}),e.jsx("span",{className:"text-sm text-gray-400",children:"|"}),e.jsx("span",{className:"text-sm text-gray-400",children:s.os})]}),e.jsx("span",{className:"text-sm text-gray-400",children:L(s.timestamp)})]}),e.jsx("div",{className:"text-white font-medium",children:s.page_path}),e.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["リファラー:"," ",s.referrer==="direct"?"直接アクセス":s.referrer]})]},a))})]}),t==="funnel"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#d4af37] mb-6",children:"流入元別ファネル分析"}),e.jsx("div",{className:"space-y-4",children:y.map(s=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-lg font-medium text-white",children:s.platform}),e.jsx("span",{className:"text-sm text-gray-400",children:s.source})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-[#d4af37]",children:s.inflow}),e.jsx("div",{className:"text-sm text-gray-400",children:"流入数"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:s.view}),e.jsx("div",{className:"text-sm text-gray-400",children:"閲覧数"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:s.conversion}),e.jsx("div",{className:"text-sm text-gray-400",children:"コンバージョン"})]})]}),s.inflow>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-sm text-gray-400 mb-1",children:["コンバージョン率: ",(s.conversion/s.inflow*100).toFixed(1),"%"]}),e.jsx("div",{className:"bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full",style:{width:`${s.conversion/s.inflow*100}%`}})})]})]},s.source))})]}),e.jsxs("div",{className:"bg-black/50 backdrop-blur-sm border border-[#d4af37]/30 rounded-xl p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#d4af37] mb-6",children:"リファラー別アクセス数"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(s=>{const a=s.count/Math.max(...i.map(b=>b.count),1)*100;return e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-lg font-medium text-white mb-3",children:s.platform}),e.jsx("div",{className:"text-2xl font-bold text-[#d4af37] mb-2",children:s.count}),e.jsx("div",{className:"bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-[#d4af37] to-[#ffd700] h-2 rounded-full transition-all duration-500",style:{width:`${a}%`}})})]},s.source)})})]})]})]},t)})})]})},je=()=>e.jsx(xe,{});export{je as default};
